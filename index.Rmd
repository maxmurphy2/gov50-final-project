---
title: "Gov 50 Final Project"
author: "Max Murphy"
description: "Forecasting Violent Conflict"
output:
  distill::distill_article:
    self_contained: false
---



## Proposal

Should we expect the effects of climate change to increase the frequency of violent conflicts? There is a growing concern that as weather patterns become more extreme and unpredictable, there will be a concomitant increase in violent conflict, namely civil war. However, what remains unclear is whether there have already been violent conflicts that have been fueled by climate change. As such, in this paper I will interrogate the relationship between changes in temperature and precipitation and violent conflict in Sudan between 1997 and 2021. The reason for the focus on temperature and precipitation change is because these are both likely to become more inconstant due to climate change, and the rationale behind analyzing these effects in Sudan is because the civil war in Sudan has been dubbed “the first climate change conflict” (World Food Program USA, 2017). My hypothesis is that an increase in temperature and a decrease in precipitation will be correlated with higher rates of violent conflict in Sudan. Given that much of Sudan’s population is dependent upon rain-fed farming, it follows that in drier and warmer periods might lead to economic stress - and economic welfare is one of the most strongly correlated factors with violent conflict. The two explanatory variables - which are observed annual mean temperature per year and observed annual precipitation per year, respectively - are both taken from the Climatic Research Unit (CRU) of University of East Anglia. Meanwhile, using data from ACLED, the outcome variable is the number of fatalities from battles, protests, riots, violence against civilians, and explosions/remove violence each year. If the number of fatalities is higher in the years that have higher average temperatures and lower average precipitation levels, this would lend support to my hypothesis. Conversely, if fatality levels are not correlated with a change in temperature or precipitation, then this would provide evidence against my hypothesis.

```{r, echo=FALSE}
# Load in the data and libraries
library(tidyverse)
ACLED <- read_csv("data/1997-10-01-2021-10-01-South_Sudan-Sudan.csv")
avg_monthly <- read_csv("data/monthly-climatology-of-min-temperature,-mean-temperature,-max-temperature-&-precipitation-1991-2020_br__sudan.csv")
avg_annual_temp <- read_csv("data/observed-average-annual-mean-temperature-of-sudan-for-1901-2021 (1).csv")
avg_annual_precip <- read_csv("data/observed-annual-precipitation,-1901-2021_br__sudan.csv")
```

```{r}
# I'm going to compare the following things:
# 1a The average annual temp vs annual no. of fatalities (normal and lagged)
# 2a The average annual precip vs annual no. of fatalities (normal and lagged)

# 3. The average monthly temp vs average monthly no. of fatalities (i.e.do fatalities tend to be higher in hotter months)
# 4. The average monthly precip vs average monthly no. of fatalities (i.e.do fatalities tend to be higher in drier months)

# And then if I have more time, maybe see if any of this changes depending on the type of event (e.g. violence against civilians). This might be interesting to explore. 

# Create new column with  the count of fatalities per year
ACLED <- ACLED |>
  group_by(year) |>
  mutate(n = sum(fatalities))

# Change name from Category to year
avg_annual_temp <- avg_annual_temp |>
  rename("year" = "Category")

# Filter temp data past 1997
avg_annual_temp <- avg_annual_temp |>
  filter(year >= 1997)

# Merge the two datasets
temp_fatalities <- unique(merge(ACLED[ , c("year", "n")], avg_annual_temp, by = "year", all.x=TRUE))

# Bar chart of fatalities per year
fatalities_bar <- ACLED |>
  ggplot(mapping = aes(x = year, y = fatalities)) +
         geom_bar(stat='identity', fill = "steelblue1") + 
  labs(
    x = "Year",
    y = "Number of fatalities",
    title = "Number of fatalities per year"
  )

# Scatter graph of temperature per year 
temp_scatter <- avg_annual_temp |>
  ggplot(mapping = aes(x = year, y = `Annual Mean`)) +
         geom_point(color = "steelblue1") + 
  labs(
    x = "Year",
    y = "Average Annual Temperature (°C)",
    title = "Average Temperature Over Time"
  )

fatalities_bar

temp_scatter
```

```{r, echo=FALSE}
# 1a Create a scatter graph that compares the average annual temp vs annual no. of fatalities 
temp_fat_scatter <- ggplot(temp_fatalities,
                           aes(x = `Annual Mean`,
                               y = n)) +
  geom_point(color = "steelblue1") +
  labs(
    x = "Average Annual Temperature (°C)",
    y = "Number of annual fatalities",
    title = "Average Annual Temp & Annual Fatalities") +
  geom_smooth(method = "lm", se = F, color = "indianred1", size = 1.5)

temp_fat_scatter
```

```{r}
# 1b Run a linear regression that compares the average annual temp vs annual no. of fatalities 
library(broom)


fit_1 <- lm(n ~ `Annual Mean`, data = temp_fatalities)

fit_1 |>
  broom::tidy() |>
  select(term, estimate) |>
  knitr::kable(digits = 2)
```

A 1-unit increase in X (1 degrees C) is associated with an increase in 676.9 annual fatalities.

```{r}
# 1c Compare the average annual temp vs annual no. of fatalities LAGGED 1yr version

# Lag the data so date values move up one row
shift <- function(x, n){
  c(x[-(seq(n))], rep(NA, n))
}

temp_fatalities_lag <- temp_fatalities
  
temp_fatalities_lag$year <- shift(temp_fatalities_lag$year, 1)

# Run a regression for the lagged version  

fit_1.5 <- lm(n ~ `Annual Mean`, data = temp_fatalities)

fit_1.5 |>
  broom::tidy() |>
  select(term, estimate) |>
  knitr::kable(digits = 2)
```
The output of the regression does not seem to change significantly when looking at the relationship between annual fatalities one year after the average annual temperature. 


```{r, echo=FALSE}
# 2a Create a scatter graph that compares the average annual precip vs annual no. of fatalities 

# Change name from Category to year
#avg_annual_precip <- avg_annual_precip |>
  #rename("year" = "Category")

# Merge the datasets
precip_fatalities <- unique(merge(ACLED[ , c("year", "n")], avg_annual_precip, by = "year", all.x=TRUE))

# Scattergraph 
precip_fat_scatter <- ggplot(precip_fatalities,
       aes(x = Precipitation,
           y = n)) +
  geom_point(color = "steelblue1") +
  labs(
    x = "Average Precipitation (mm)",
    y = "Number of annual fatalities",
    title = "Average Annual Precip & Annual Fatalities") +
  geom_smooth(method = "lm", se = F, color = "indianred1", size = 1.5)

precip_fat_scatter
```

```{r}
# 2b Run a linear regression that compares the average annual precip vs annual no. of fatalities 

fit_2 <- lm(n ~ Precipitation, data = precip_fatalities)

fit_2 |>
  broom::tidy() |>
  select(term, estimate) |>
  knitr::kable(digits = 2)
```

A 1-unit increase in X (1mm of average annual precipitation) is associated with a decrease in 21.13 annual fatalities. 

```{r}
# 2c Compare the average annual precip vs annual no. of fatalities LAGGED 1yr version

# Create lagged version of the dataset
precip_fatalities_lag <- precip_fatalities
precip_fatalities_lag$year <- shift(precip_fatalities_lag$year, 1)

# Run a regression for the lagged version  

fit_2.5 <- lm(n ~ Precipitation, data = precip_fatalities)

fit_2.5 |>
  broom::tidy() |>
  select(term, estimate) |>
  knitr::kable(digits = 2)
```

```{r}
# 3a The average monthly temp vs average monthly no. of fatalities (i.e.do fatalities tend to be higher in hotter months)

# First, using ACLED, I need to find the average number of fatalities by month
#name_to_date <- function(x) {
 # lubridate::dmy(x)
#}

#dplyr::mutate_all(ACLED$year, name_to_date)
# First filter by cells which have a fatality

# This one works - but how to apply to whole thing? lubridate::dmy("30 September 2021")



# Second, I need to find the average temperature per month


# Then lastly I need to compare the two together


```

